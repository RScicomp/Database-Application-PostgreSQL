DROP TABLE Banks CASCADE;
DROP TABLE Branch CASCADE;
DROP TABLE People CASCADE;
DROP TABLE Bankers CASCADE;
DROP TABLE Customers CASCADE;
DROP TABLE Accounts CASCADE;
DROP TABLE Checkings CASCADE;
DROP TABLE Savings CASCADE;
DROP TABLE Transactions CASCADE;
DROP TABLE Withdrawals CASCADE;
DROP TABLE Deposits CASCADE;

--Institutions
CREATE TABLE Banks(
nameB VARCHAR(20) NOT NULL,
PRIMARY KEY(nameB)
);

CREATE TABLE Branch(
brID INTEGER NOT NULL,
nameB VARCHAR(20) NOT NULL,
city VARCHAR(20) NOT NULL,
PRIMARY KEY(brID, nameB),
FOREIGN KEY(nameB) REFERENCES Banks
);

--People

CREATE TABLE People(
pID VARCHAR(10) NOT NULL,
addr VARCHAR(30),
name VARCHAR(20),
phoneNum BIGINT,
PRIMARY KEY(pID)
);

CREATE TABLE Bankers(
pidB VARCHAR(10) NOT NULL,		
brID INTEGER NOT NULL,
nameB VARCHAR(20) NOT NULL,
PRIMARY KEY (pidB), 
FOREIGN KEY(pidB) REFERENCES People(pID),
FOREIGN KEY(brID, nameB) REFERENCES Branch(brID,nameB)
);

CREATE TABLE Customers(
pidC VARCHAR(10) NOT NULL,
pidB VARCHAR(10) NOT NULL,
PRIMARY KEY(pidC),
FOREIGN KEY(pidC) REFERENCES People(pID),
FOREIGN KEY(pidB) REFERENCES Bankers(pidB)
);

--Accounts
CREATE TABLE Accounts(
aID VARCHAR(10) NOT NULL,
currency VARCHAR(6) NOT NULL,
openDate DATE NOT NULL,
balance FLOAT NOT NULL,
nameB VARCHAR(20) NOT NULL,
pidC VARCHAR(10) NOT NULL,
pidB VARCHAR(10) NOT NULL,
PRIMARY KEY(aID),
FOREIGN KEY(pidB) REFERENCES Bankers(pidB),
FOREIGN KEY(pidC) REFERENCES Customers(pidC),
FOREIGN KEY(brID, nameB) REFERENCES Branch(brID,nameB)
);


CREATE TABLE Checkings(
aidC VARCHAR(10) NOT NULL,
PRIMARY KEY(aidC),
FOREIGN KEY(aidC) REFERENCES Accounts(aID)
);


CREATE TABLE Savings(
aidS VARCHAR(10) NOT NULL,
interestRate FLOAT NOT NULL,
PRIMARY KEY(aidS),
FOREIGN KEY(aidS) REFERENCES Accounts(aID)
);

--Transactions
CREATE TABLE Transactions(
tID VARCHAR(10) NOT NULL,
dateOf DATE NOT NULL,
timeOf TIME NOT NULL, 
amt FLOAT NOT NULL,
statusOf VARCHAR(20) NOT NULL,
PRIMARY KEY(tID)
);

CREATE TABLE Withdrawals(
tidW VARCHAR(10) NOT NULL,
aidC VARCHAR(10) NOT NULL,
PRIMARY KEY(tidW),
FOREIGN KEY(tidW) REFERENCES Transactions(tID),
FOREIGN KEY(aidC) REFERENCES Checkings(aidC)
);

CREATE TABLE Deposits(
tidD VARCHAR(10) NOT NULL,
aID VARCHAR(10) NOT NULL,
PRIMARY KEY(tidD),
FOREIGN KEY(tidD) REFERENCES Transactions(tID),
FOREIGN KEY(aID) REFERENCES Accounts(aID)
);


CREATE TABLE Transfers(
tidT VARCHAR(10) NOT NULL,
aidSrc VARCHAR(10) NOT NULL,
aidDest VARCHAR(10) NOT NULL,
fee FLOAT NOT NULL,
PRIMARY KEY(tidT),
FOREIGN KEY(tidT) REFERENCES Transactions(tID),
FOREIGN KEY(aidSrc) REFERENCES Accounts(aID),
FOREIGN KEY (aidDest) REFERENCES Accounts(aID)
);
